//
// Created by hgpnguyen on 7/6/2019.
//
#include <iostream>

#include "gtest/gtest.h"
#include <libfuzzer/LoadContractEth.h>
#include <curl/curl.h>

using namespace fuzzer;
using namespace std;

TEST(LoadContract, loadContract) {
    LoadContractEth loadContract;
    string bin = loadContract.getByteCode("0x54e74f609988C55bF9327185508C0037b1F2e960");
    string actualBin = "0x60806040526004361061006c5763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416633853682c811461006e5780633fad9ae014610081578063bedf0f4a1461010b578063c76de3e914610113578063ed8df1641461019d575b005b61006c60048035602481019101356101eb565b34801561008d57600080fd5b50610096610264565b6040805160208082528351818301528351919283929083019185019080838360005b838110156100d05781810151838201526020016100b8565b50505050905090810190601f1680156100fd5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61006c6102f2565b6040805160206004803580820135601f810184900484028501840190955284845261006c94369492936024939284019190819084018382808284375050604080516020601f89358b018035918201839004830284018301909452808352979a99988101979196509182019450925082915084018382808284375094975061035d9650505050505050565b6040805160206004803580820135601f810184900484028501840190955284845261006c943694929360249392840191908190840183828082843750949750509335945061040f9350505050565b3332146101f757600080fd5b8181604051808383808284376040519201829003909120600154149350508215915061022c9050575067058d15e17628000034115b15610260576040513390303180156108fc02916000818181858888f1935050505015801561025e573d6000803e3d6000fd5b505b5050565b6000805460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156102ea5780601f106102bf576101008083540402835291602001916102ea565b820191906000526020600020905b8154815290600101906020018083116102cd57829003601f168201915b505050505081565b604080516c0100000000000000000000000033028152815190819003601401902060009081526002602052205460ff16151561032d57600080fd5b6040513390303180156108fc02916000818181858888f1935050505015801561035a573d6000803e3d6000fd5b50565b604080516c0100000000000000000000000033028152815190819003601401902060009081526002602052205460ff16151561039857600080fd5b600154151561026057806040518082805190602001908083835b602083106103d15780518252601f1990920191602091820191016103b2565b51815160209384036101000a600019018019909216911617905260405191909301819003902060015550845161025e93506000925090850190610464565b604080516c0100000000000000000000000033028152815190819003601401902060009081526002602052205460ff16151561044a57600080fd5b815161045d906000906020850190610464565b5060015550565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106104a557805160ff19168380011785556104d2565b828001600101855582156104d2579182015b828111156104d25782518255916020019190600101906104b7565b506104de9291506104e2565b5090565b6104fc91905b808211156104de57600081556001016104e8565b905600a165627a7a72305820c985c628f1ba984e6994785bfcac53f3967760a420e1cb4e39c168e632ddeac20029";
    ASSERT_EQ(actualBin, bin);

}
